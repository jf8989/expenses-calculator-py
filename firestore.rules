rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    match /project-planning-responses/{responseId} {
      // Allow creation by anyone, but only if no submission exists yet.
      // NOTE: This assumes we use a fixed ID like 'submission' to check for existence,
      // as Firestore rules cannot check if a collection is empty for dynamic IDs.
      allow create: if !exists(/databases/$(database)/documents/project-planning-responses/lock);
      
      // Only the admin can read, update, or delete submissions
      allow read, update, delete: if request.auth.token.email == "jf.apps.lab@gmail.com";
    }
  }
}
